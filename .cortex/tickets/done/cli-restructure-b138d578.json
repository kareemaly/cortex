{
  "id": "b138d578-9dbf-4dd5-a622-21c257875fe4",
  "title": "CLI Restructure",
  "body": "Restructure CLI commands under `cortex ticket` subcommand and add mode flags.\n\n## Context\n\nThis is a fresh project with no users. No backward compatibility needed. Breaking changes are fine. Do not accumulate tech debt.\n\n## Command Changes\n\n### Before\n```\ncortex list [--status] [--json]\ncortex spawn <ticket-id> [--json]\ncortex session <ticket-id> [--json]\ncortex architect [--detach]\n```\n\n### After\n```\ncortex ticket list [--status] [--query] [--json]\ncortex ticket spawn <id> [--resume] [--fresh] [--json]\ncortex ticket <id> [--json]                          # shows ticket details (replaces session)\ncortex architect [--resume] [--fresh] [--detach]\n```\n\n## Details\n\n### `cortex ticket` subcommand\nCreate parent command that groups ticket operations.\n\n### `cortex ticket list`\n- Add `--query` flag for text search (matches API)\n- Keep `--status` and `--json` flags\n\n### `cortex ticket spawn <id>`\n- Add `--resume` flag (mode=resume for orphaned sessions)\n- Add `--fresh` flag (mode=fresh for orphaned sessions)\n- Default mode=normal\n\n### `cortex ticket <id>`\n- Replaces `cortex session` command\n- Shows ticket details with session info\n- Keep `--json` flag\n\n### `cortex architect`\n- Add `--resume` flag\n- Add `--fresh` flag\n- Keep `--detach` flag\n- Uses SDK `SpawnArchitect(mode)`\n\n## Files to Change\n\n- `cmd/cortex/commands/list.go` \u2192 `cmd/cortex/commands/ticket_list.go`\n- `cmd/cortex/commands/spawn.go` \u2192 `cmd/cortex/commands/ticket_spawn.go`\n- `cmd/cortex/commands/session.go` \u2192 `cmd/cortex/commands/ticket_show.go`\n- `cmd/cortex/commands/ticket.go` (new) - parent command\n- `cmd/cortex/commands/architect.go` - add flags\n- `cmd/cortex/commands/root.go` - update command registration\n\n## Verification\n\n```bash\nmake lint\nmake test\nmake build\nmake test-integration\n\n# Manual verification\ncortex ticket list --status backlog\ncortex ticket list --query \"search term\"\ncortex ticket spawn <id> --resume\ncortex architect --resume\n```\n\n## Implementation\n\n### Commits Pushed\n- `f4977fd` feat: restructure CLI under ticket subcommand with mode flags\n\n### Key Files Changed\n- `cmd/cortex/commands/ticket.go` - New parent command for ticket operations\n- `cmd/cortex/commands/ticket_list.go` - List command with --query flag (renamed from list.go)\n- `cmd/cortex/commands/ticket_spawn.go` - Spawn command with --resume/--fresh flags (renamed from spawn.go)\n- `cmd/cortex/commands/ticket_show.go` - Show ticket details (renamed from session.go)\n- `cmd/cortex/commands/architect.go` - Simplified to use SDK, added --resume/--fresh flags\n- `internal/cli/sdk/client.go` - Added query parameter to ListAllTickets/ListTicketsByStatus\n- `internal/daemon/api/tickets.go` - Added query parameter support to list handlers\n- `internal/daemon/api/types.go` - Added filterSummaryList helper with query filtering\n\n### Important Decisions\n- Architect command now uses SDK `SpawnArchitect(mode)` instead of direct tmux logic, simplifying the CLI code significantly\n- Query filter is case-insensitive and matches against both title and body (same as MCP handler)\n- Removed unused `toSummaryList` function, replaced with `filterSummaryList` that handles query filtering\n\n### Scope Changes\n- No changes from original ticket scope",
  "dates": {
    "created": "2026-01-23T07:12:57Z",
    "updated": "2026-01-23T07:12:57Z",
    "done": "2026-01-23T07:12:57Z"
  },
  "comments": [],
  "session": null
}
