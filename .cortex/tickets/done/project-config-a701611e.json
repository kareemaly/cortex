{
  "id": "a701611e-a4ef-4cdc-8c12-bb16e93a4a2f",
  "title": "Project Config",
  "body": "Implement project-level configuration loading from `.cortex/cortex.yaml`.\n\n## Context\n\nEach project has a `.cortex/cortex.yaml` file that defines project settings, git repos, and lifecycle hooks.\n\nSee `DESIGN.md` for:\n- Project config schema (lines 272-293)\n- Git repos config (lines 279-282)\n- Lifecycle hooks config (lines 284-293)\n\n## Requirements\n\nCreate or extend config package to load project config:\n\n1. **Config Structure**\n   ```yaml\n   name: project-name\n   agent: claude  # or other agent types\n\n   git:\n     repos:\n       - path: \".\"\n       - path: \"packages/shared\"\n\n   lifecycle:\n     on_pickup:\n       - run: \"echo 'Starting work on {{ticket_slug}}'\"\n     on_submit:\n       - run: \"npm run lint\"\n       - run: \"npm run test\"\n     on_approve:\n       - run: \"git add -A\"\n       - run: \"git commit -m '{{commit_message}}'\"\n   ```\n\n2. **Loading**\n   - Find `.cortex/cortex.yaml` from current or parent directories\n   - Parse YAML into Go structs\n   - Validate required fields\n   - Return sensible defaults for optional fields\n\n3. **Discovery**\n   - `FindProjectRoot(path)` - walk up to find `.cortex/` directory\n   - `Load(projectPath)` - load config from project root\n\n4. **Integration Points**\n   - Lifecycle hooks use this for hook definitions\n   - Git discovery uses this for repo paths\n   - Daemon uses this for project detection\n\n## Verification\n\n```bash\nmake build   # Builds successfully\nmake test    # Tests pass\nmake lint    # No lint errors\n```\n\n## Notes\n\n- This is separate from daemon's global config (~/.cortex/settings.yaml)\n- Project config is per-project, global config is per-user\n- Handle missing config file gracefully (use defaults)\n- Consider caching loaded config\n\n## Implementation\n\n### Commits Pushed\n- `2c14940` feat: add project config package for loading .cortex/cortex.yaml\n- `6913e2d` Merge branch 'ticket/2026-01-19-project-config'\n\n### Key Files Changed\n- `internal/project/config/config.go` - Config structs (Config, GitConfig, RepoConfig, LifecycleConfig, HookConfig) and functions (DefaultConfig, FindProjectRoot, Load, LoadFromPath, Validate)\n- `internal/project/config/errors.go` - Error types (ProjectNotFoundError, ConfigParseError, ValidationError) with Is* helpers\n- `internal/project/config/config_test.go` - 12 test cases covering all functionality\n\n### Important Decisions\n- Package placed at `internal/project/config/` to separate from daemon config (`internal/daemon/config/`)\n- `FindProjectRoot` walks up directory tree using `os.Stat` to find `.cortex/` directory\n- Default config: agent=`claude`, repos=[`\".\"`], no lifecycle hooks\n- Missing config file returns defaults without error (graceful handling)\n- Agent type restricted to `claude` or `opencode`\n- Validation ensures non-empty repo paths and hook run commands\n\n### Scope Changes\n- None - implemented as specified in the plan",
  "dates": {
    "created": "2026-01-20T13:40:11Z",
    "updated": "2026-01-20T13:40:11Z",
    "done": "2026-01-20T13:40:11Z"
  },
  "comments": [],
  "session": null
}
