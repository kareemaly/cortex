{
  "id": "eb9f2e43-52d1-4a6e-b306-2d6fc0d99a18",
  "title": "Project Foundation",
  "body": "Set up the Go project structure, build system, and code quality tooling for cortex1.\n\n## Context\n\nThis is a fresh Go project. Reference `~/projects/cortex` (cortex0) for patterns but adapt for v1 architecture per `DESIGN.md`.\n\n## Requirements\n\n### 1. Go Module\n\nCreate `go.mod` with:\n- Module path: `github.com/kareemaly/cortex1`\n- Go version: 1.24\n\nInitial dependencies (add to go.mod, run `go mod tidy`):\n```\ngithub.com/modelcontextprotocol/go-sdk  # MCP server\ngithub.com/go-chi/chi/v5                # HTTP router\ngithub.com/spf13/cobra                  # CLI framework\ngithub.com/charmbracelet/bubbletea      # TUI framework\ngithub.com/charmbracelet/lipgloss       # TUI styling\ngithub.com/google/uuid                  # UUIDs\ngopkg.in/yaml.v3                        # Config parsing\ngopkg.in/natefinch/lumberjack.v2        # Log rotation\n```\n\n### 2. Directory Structure\n\n```\ncortex1/\n\u251c\u2500\u2500 cmd/\n\u2502   \u251c\u2500\u2500 cortex/           # CLI binary\n\u2502   \u2502   \u2514\u2500\u2500 main.go       # Minimal: prints \"cortex v0.0.0-dev\"\n\u2502   \u2514\u2500\u2500 cortexd/          # Daemon binary\n\u2502       \u2514\u2500\u2500 main.go       # Minimal: prints \"cortexd v0.0.0-dev\"\n\u251c\u2500\u2500 internal/\n\u2502   \u251c\u2500\u2500 cli/              # CLI internals (empty, create .gitkeep)\n\u2502   \u2502   \u251c\u2500\u2500 sdk/          # HTTP client for daemon\n\u2502   \u2502   \u2514\u2500\u2500 tui/          # Bubbletea views\n\u2502   \u2514\u2500\u2500 daemon/           # Daemon internals (empty, create .gitkeep)\n\u2502       \u251c\u2500\u2500 api/          # HTTP server\n\u2502       \u251c\u2500\u2500 mcp/          # MCP server\n\u2502       \u2514\u2500\u2500 config/       # Configuration\n\u251c\u2500\u2500 pkg/\n\u2502   \u2514\u2500\u2500 version/\n\u2502       \u2514\u2500\u2500 version.go    # Version info (ldflags)\n\u251c\u2500\u2500 .golangci.yml\n\u251c\u2500\u2500 lefthook.yml\n\u251c\u2500\u2500 .editorconfig\n\u251c\u2500\u2500 CLAUDE.md\n\u251c\u2500\u2500 Makefile\n\u2514\u2500\u2500 go.mod\n```\n\n### 3. pkg/version/version.go\n\n```go\npackage version\n\nimport (\n\t\"fmt\"\n\t\"runtime\"\n)\n\nvar (\n\tVersion   = \"dev\"\n\tCommit    = \"unknown\"\n\tBuildDate = \"unknown\"\n)\n\ntype Info struct {\n\tVersion   string\n\tCommit    string\n\tBuildDate string\n\tGoVersion string\n\tPlatform  string\n}\n\nfunc Get() Info {\n\treturn Info{\n\t\tVersion:   Version,\n\t\tCommit:    Commit,\n\t\tBuildDate: BuildDate,\n\t\tGoVersion: runtime.Version(),\n\t\tPlatform:  fmt.Sprintf(\"%s/%s\", runtime.GOOS, runtime.GOARCH),\n\t}\n}\n\nfunc String() string {\n\treturn fmt.Sprintf(\"%s (commit: %s, built: %s)\", Version, Commit, BuildDate)\n}\n```\n\n### 4. Makefile\n\n```makefile\nVERSION ?= $(shell git describe --tags --always --dirty 2>/dev/null || echo \"dev\")\nCOMMIT  ?= $(shell git rev-parse --short HEAD 2>/dev/null || echo \"unknown\")\nDATE    ?= $(shell date -u +\"%Y-%m-%dT%H:%M:%SZ\")\n\nLDFLAGS := -ldflags \"-X github.com/kareemaly/cortex1/pkg/version.Version=$(VERSION) \\\n                     -X github.com/kareemaly/cortex1/pkg/version.Commit=$(COMMIT) \\\n                     -X github.com/kareemaly/cortex1/pkg/version.BuildDate=$(DATE)\"\n\n.PHONY: all build cortex cortexd install lint test clean\n\nall: build\n\nbuild: cortex cortexd\n\ncortex:\n\tgo build $(LDFLAGS) -o bin/cortex ./cmd/cortex\n\ncortexd:\n\tgo build $(LDFLAGS) -o bin/cortexd ./cmd/cortexd\n\ninstall: build\n\tcp bin/cortex $(GOPATH)/bin/\n\tcp bin/cortexd $(GOPATH)/bin/\n\nlint:\n\tgolangci-lint run\n\ntest:\n\tgo test -v ./...\n\ntest-coverage:\n\tgo test -coverprofile=coverage.out ./...\n\tgo tool cover -html=coverage.out -o coverage.html\n\nclean:\n\trm -rf bin/\n\trm -f coverage.out coverage.html\n```\n\n### 5. .golangci.yml\n\n```yaml\nversion: \"2\"\nrun:\n  timeout: 5m\n```\n\n### 6. lefthook.yml\n\n```yaml\npre-commit:\n  parallel: true\n  commands:\n    lint:\n      run: golangci-lint run\n    build:\n      run: go build ./...\n```\n\n### 7. .editorconfig\n\n```ini\nroot = true\n\n[*]\nend_of_line = lf\ninsert_final_newline = true\ncharset = utf-8\nindent_style = tab\nindent_size = 4\n\n[*.{yaml,yml,json,md}]\nindent_style = space\nindent_size = 2\n\n[Makefile]\nindent_style = tab\n```\n\n### 8. CLAUDE.md\n\n```markdown\n# Cortex1\n\nOrchestration layer for AI coding workflows. File-based ticket management with MCP tools for agent interaction.\n\n## Quick Reference\n\n- **Build**: `make build` (outputs to `bin/`)\n- **Lint**: `make lint`\n- **Test**: `make test`\n\n## Architecture\n\nSee `DESIGN.md` for full architecture. Key points:\n\n- `cortexd`: Daemon with HTTP API + MCP server\n- `cortex`: CLI + TUI for humans\n- Tickets are JSON files in `.cortex/tickets/{backlog,progress,done}/`\n- Agents interact via MCP tools, not REST API\n\n## Code Style\n\n- Use `slog` for structured logging\n- Chi for HTTP routing\n- Cobra for CLI commands\n- Bubbletea for TUI\n\n## Directory Layout\n\n- `cmd/cortex/` - CLI entry point\n- `cmd/cortexd/` - Daemon entry point\n- `internal/cli/` - CLI internals (sdk, tui)\n- `internal/daemon/` - Daemon internals (api, mcp, config)\n- `pkg/version/` - Version info\n```\n\n### 9. cmd/cortex/main.go\n\nMinimal main that prints version:\n\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"github.com/kareemaly/cortex1/pkg/version\"\n)\n\nfunc main() {\n\tfmt.Printf(\"cortex %s\\n\", version.String())\n}\n```\n\n### 10. cmd/cortexd/main.go\n\nMinimal main that prints version:\n\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"github.com/kareemaly/cortex1/pkg/version\"\n)\n\nfunc main() {\n\tfmt.Printf(\"cortexd %s\\n\", version.String())\n}\n```\n\n## Verification\n\nAfter implementation:\n\n```bash\n# Build succeeds\nmake build\n\n# Binaries exist and print version\n./bin/cortex\n./bin/cortexd\n\n# Lint passes\nmake lint\n\n# Tests pass (trivially, no tests yet)\nmake test\n```\n\n## Notes\n\n- Don't add business logic yet - this is pure scaffolding\n- Keep .gitkeep files in empty directories so git tracks them\n- The cmd/*/main.go files are intentionally minimal\n\n## Implementation\n\n### Commits\n\n- `d32ec21` feat: add initial Go project scaffolding\n\n### Key Files Changed\n\n- `go.mod` - Module init (Go 1.24)\n- `pkg/version/version.go` - Version with ldflags support\n- `cmd/cortex/main.go` - CLI entry point\n- `cmd/cortexd/main.go` - Daemon entry point\n- `Makefile` - Build, lint, test, clean targets\n- `.golangci.yml` - Linter config (v2 format)\n- `lefthook.yml` - Pre-commit hooks\n- `.editorconfig` - Editor settings\n- `.gitignore` - Excludes bin/\n- `CLAUDE.md` - Developer reference\n- `internal/cli/{sdk,tui}/.gitkeep` - Placeholder directories\n- `internal/daemon/{api,mcp,config}/.gitkeep` - Placeholder directories\n\n### Decisions Made\n\n1. **Simplified version.go** - Used a simpler `String(name string)` function instead of the full `Info` struct. The struct can be added later when needed for JSON output.\n\n2. **Deferred dependencies** - Did not add the dependencies listed in requirements (cobra, chi, bubbletea, etc.) since they're not used yet. Will add when implementing actual functionality to avoid unused imports.\n\n3. **golangci-lint v2 format** - Used `formatters:` section for gofmt/goimports as required by v2, rather than listing them under `linters.enable`.\n\n4. **Added .gitignore** - Not in original spec but necessary to exclude `bin/` from version control.\n\n### Scope Changes\n\n- Dependencies deferred until actually needed (cleaner go.mod)\n- Simplified version package (Info struct can be added later)",
  "dates": {
    "created": "2026-01-19T13:18:01Z",
    "updated": "2026-01-19T13:18:01Z",
    "done": "2026-01-19T13:18:01Z"
  },
  "comments": [],
  "session": null
}
