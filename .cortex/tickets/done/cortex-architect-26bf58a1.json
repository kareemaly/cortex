{
  "id": "26bf58a1-9ce5-4625-8e81-e27eda8723d8",
  "title": "Cortex Architect Command",
  "body": "Implement the `cortex architect` command to start or attach to an architect session.\n\n## Context\n\nThe architect is a singleton session per project that lives in tmux window 0. It has full MCP tools for ticket management and spawning ticket sessions.\n\nSee `DESIGN.md` for:\n- Architect session description (lines 57-62)\n- CLI command (line 47)\n- Tmux window 0 reserved for architect (line 159)\n- Agent spawning with MCP config (lines 356-378)\n\nExisting packages to use:\n- `internal/tmux` - SpawnArchitect, AttachSession, SessionExists\n- `internal/project/config` - load agent type, project name\n- `internal/git` - capture git_base\n\n## Requirements\n\nImplement `cortex architect` command that:\n\n1. **Find or Create Architect Session**\n   - Check if tmux session exists for project\n   - Check if window 0 has running architect\n   - If running: attach to it\n   - If not: spawn new architect\n\n2. **Spawn Architect**\n   - Use tmux window 0 (reserved for architect)\n   - Generate MCP config file (no --ticket-id = architect mode)\n   - Run agent command with project context prompt\n   - Capture git_base for session tracking\n\n3. **Attach to Existing**\n   - If architect already running, just attach to tmux window\n   - Don't spawn duplicate architects\n\n4. **Project Detection**\n   - Find project root from current directory\n   - Load project config for agent type and name\n   - Use project name as tmux session name\n\n## Verification\n\n```bash\nmake build\nmake lint\nmake test\n\n# Manual test\ncd /some/project/with/.cortex\ncortex architect  # Should spawn or attach\n```\n\n## Notes\n\n- Architect is singleton per project (only one at a time)\n- Window 0 is reserved - don't use regular CreateWindow\n- Should work from any subdirectory of project\n- Consider adding --detach flag to spawn without attaching\n\n## Implementation\n\n### Commits Pushed\n\n- `019fcd6` feat: implement cortex architect command\n- `ac76a66` feat: add tickets for architect, kanban, and install commands\n\n### Key Files Changed\n\n- `cmd/cortex/commands/architect.go` - Main command implementation\n- `internal/tmux/command.go` - Added `SpawnArchitect()` helper for window 0\n\n### Important Decisions\n\n1. **git_base not needed for architect**: The ticket mentioned capturing git_base, but after analysis, this is only relevant for ticket sessions that write code. The architect manages tickets and spawns sessions\u2014it doesn't write code directly. git_base is already captured when spawning ticket sessions in `tools_architect.go:343-359`.\n\n2. **--detach flag implemented**: Added support for `--detach` to spawn the architect without attaching to it immediately.\n\n3. **MCP config generation**: The architect gets an MCP config without `--ticket-id`, which enables the full architect toolset (ticket CRUD, session spawning) rather than the limited ticket-session toolset.\n\n### Scope Changes\n\nNone - all original requirements were implemented as specified.",
  "dates": {
    "created": "2026-01-20T15:44:45Z",
    "updated": "2026-01-20T15:44:45Z",
    "done": "2026-01-20T15:44:45Z"
  },
  "comments": [],
  "session": null
}
