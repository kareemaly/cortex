{
  "id": "9c35588f-d8ee-4e8b-a88b-0bff0ef8491d",
  "title": "Ticket TUI Overhaul: Row-Based Layout with Unified Comment List",
  "body": "## Summary\n\nRedesign the ticket detail TUI from the current 70/30 horizontal split to a row-based layout with two vertically stacked sections that dynamically resize based on focus. Render all comments (including reviews) in a unified list with type-based visual styling and strip-and-truncate markdown previews.\n\n**Depends on**: \"Simplify Comment Model\" ticket (needs the unified comment model with 4 types and no separate reviews)\n\n## Current State\n\n- Split layout: 70% left (body), 30% right (metadata + reviews + comments)\n- h/l switches panel focus\n- Reviews and comments rendered separately in sidebar\n- Comments show type badge + title\n- o/Enter opens detail modal\n\n## Target State\n\n### Layout\n\n```\n┌──────────────────────────────────────────────────┐\n│ [ID]  Title                           [status]   │  ← Header (fixed)\n├───────────────────────────────┬──────────────────┤\n│                               │  DETAILS         │\n│  Ticket description           │  created: ...    │  ← Row 1\n│  (markdown rendered)          │  type: work      │\n│                               │  session: ...    │\n├───────────────────────────────┴──────────────────┤\n│ [blocker]  Agent can't find the config file af…  │\n│ [comment]  Updated spawn logic to handle new t…  │  ← Row 2\n│ [review]   All changes complete, ready for rev…  │\n│ [done]     Session concluded. Implemented all …  │\n└──────────────────────────────────────────────────┘\n```\n\n- **Header**: ticket ID, title, status badge (fixed height, always visible)\n- **Row 1**: 70% width ticket description (markdown), 30% width attributes sidebar (dates, type, session info)\n- **Row 2**: full-width unified comment list\n- Focused row takes **70% of vertical space**, unfocused row takes 30%\n- Default focus: Row 1\n\n### Navigation\n\n- `Tab` / `Shift+Tab` — switch focus between Row 1 and Row 2\n- **Row 1 focused**: j/k scrolls ticket description\n- **Row 2 focused**: j/k navigates between comments in the list\n- `Enter` on a selected comment — opens full-screen detail modal with full markdown-rendered content, j/k scrolls within, Esc closes\n- Existing shortcuts preserved: `r` refresh, `ga` architect, `s` spawn, `a` approve, `x` kill, `q` quit\n\n### Comment list rendering\n\n- Each comment is a single line: `[type_badge]  preview_text…`\n- **Type badges** with distinct colors:\n  - `[blocker]` — red\n  - `[review]` — yellow\n  - `[comment]` — gray/default\n  - `[done]` — green\n- **Preview text**: strip markdown syntax from first non-empty line, truncate to available width with ellipsis\n  - Strip logic: trim leading `#`, `*`, `-`, `\u003e`, whitespace from first non-empty line\n  - Truncate with `…` at available terminal width minus badge width and padding\n- Selected comment highlighted with background color\n\n### Detail modal\n\n- Full-screen overlay (existing modal pattern)\n- Shows comment type badge + timestamp at top\n- Full content rendered as markdown via Glamour\n- If type is `review_requested` and action is `git_diff`: show repo_path and commit info\n- j/k scrolls content, Esc closes\n- Action shortcuts if applicable (e.g., `a` approve if review_requested)\n\n## Acceptance Criteria\n\n- [ ] Row-based layout with header, row1 (description + attributes), row2 (comments)\n- [ ] Focused row takes 70% vertical space, unfocused takes 30%\n- [ ] Tab/Shift+Tab switches focus between rows\n- [ ] Row 1: j/k scrolls ticket description, 30% sidebar shows attributes\n- [ ] Row 2: j/k navigates comment list\n- [ ] Comments rendered as single-line previews with type badge and stripped/truncated markdown\n- [ ] Strip logic handles common markdown prefixes (#, *, -, \u003e, whitespace)\n- [ ] Enter opens detail modal with full markdown-rendered comment content\n- [ ] Modal shows action metadata (repo_path, commit) for review_requested comments\n- [ ] All 4 comment types have distinct color-coded badges\n- [ ] Existing shortcuts preserved (r, ga, s, a, x, q)\n- [ ] SSE real-time updates still work\n- [ ] Works in both narrow and wide terminals",
  "dates": {
    "created": "2026-01-28T09:35:31.000965Z",
    "updated": "2026-01-28T10:31:12.248117Z",
    "progress": "2026-01-28T10:00:17.625261Z",
    "reviewed": "2026-01-28T10:25:21.047264Z",
    "done": "2026-01-28T10:31:12.248117Z"
  },
  "comments": [
    {
      "id": "e7423166-e4df-4358-bd00-86641d15d639",
      "session_id": "afe058de-e2d4-4ad3-b8a8-5ef0d0ac8606",
      "type": "ticket_done",
      "title": "Session concluded",
      "content": "## Ticket TUI Overhaul — Row-Based Layout with Unified Comment List\n\n### Summary\nReplaced the old left/right split panel layout in the ticket detail TUI (`cortex show`) with a two-row vertical layout featuring a unified comment list. The change simplifies the codebase (net -171 lines) while providing a more intuitive viewing experience.\n\n### Files Modified\n1. **`internal/cli/tui/ticket/styles.go`** — Added 6 new row/comment styles (`row2FocusedStyle`, `row2Style`, `commentSelectedStyle`, `rowSeparatorStyle`, `attributeHeaderStyle`, `attributeLabelStyle`, `attributeValueStyle`, `dotStyle`). Changed `reviewRequestedColor` from blue (39) to yellow (214). Removed 5 obsolete panel styles.\n\n2. **`internal/cli/tui/ticket/keys.go`** — Added `KeyTab` and `KeyShiftTab` constants. Rewrote `helpText()` signature to accept `focusedRow int` instead of `splitLayout, rightFocused bool`.\n\n3. **`internal/cli/tui/ticket/model.go`** — Major rewrite:\n   - Struct: `leftViewport` → `bodyViewport`, `focusedPanel` → `focusedRow`, `sidebarCursor` → `commentCursor`, `modalIsReview`+`modalItemIndex` → `modalCommentIdx`, removed `splitLayout`\n   - Added 13 new functions: `rowHeights`, `renderRow1`, `renderAttributes`, `renderCommentList`, `renderCommentLine`, `commentBadge`, `stripMarkdownPreview`, `truncateToWidth`, `commentVisibleRange`, `renderRowSeparator`, `handleCommentListKey`, `updateRowSizes`, `renderBodyContent`\n   - Removed 19 obsolete functions\n   - Rewrote 9 existing functions: `View`, `Update`, `handleKeyMsg`, `openDetailModal`, `renderDetailModal`, `renderModalHeader`, `renderModalContent`, `handleDetailModalKey`, `hasReviewRequests`\n\n### Key Decisions\n- **Row layout always used**: No toggle between single-column and split — the layout adapts based on terminal width (\u003e=100 chars for wide mode with attributes panel, \u003c100 for narrow body-only).\n- **Unified comment list**: All comment types in a single list ordered by `ticket.Comments` array, replacing the old separate REVIEWS/COMMENTS sidebar sections. This aligns with the simplified 4-type comment model.\n- **Dynamic row sizing**: Focused row gets 70% of available height, unfocused gets 30%. Tab toggles focus.\n- **Direct comment indexing**: Modal now stores `modalCommentIdx` as a direct index into `ticket.Comments`, eliminating the need for `reviewComments()` / `nonReviewComments()` split logic.\n- **Review badge color**: Changed from blue to yellow (214) to match the plan specification and differentiate from the blue status color used elsewhere.\n\n### Verification\n- `make build` — passes\n- `make lint` — 0 issues\n- `make test` — all unit tests pass\n\n### Commit\n`6d5a21a` — `feat: overhaul ticket TUI to row-based layout with unified comment list`\n\n### Follow-up Notes\n- Manual testing recommended: `cortex show \u003cticket-id\u003e` in wide (\u003e=100) and narrow (\u003c100) terminals\n- Test embedded mode from kanban board\n- Test with 0 comments, 1 comment, and many comments\n- Test SSE: add a comment via MCP tool while viewing to verify live updates",
      "created_at": "2026-01-28T10:31:12.24546Z"
    }
  ],
  "session": {
    "id": "afe058de-e2d4-4ad3-b8a8-5ef0d0ac8606",
    "started_at": "2026-01-28T10:00:17.58309Z",
    "ended_at": "2026-01-28T10:31:12.246483Z",
    "agent": "claude",
    "tmux_window": "ticket-tui-overhaul-row-based-layout-with-unified-",
    "current_status": {
      "status": "in_progress",
      "tool": "Bash",
      "work": null,
      "at": "2026-01-28T10:30:54.028006Z"
    },
    "status_history": [
      {
        "status": "starting",
        "tool": null,
        "work": null,
        "at": "2026-01-28T10:00:17.58309Z"
      },
      {
        "status": "in_progress",
        "tool": "mcp__cortex__readTicket",
        "work": null,
        "at": "2026-01-28T10:00:37.708258Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:42.769069Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:42.897865Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:43.040421Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:00:43.511664Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:48.197854Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:48.198524Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:48.198956Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:48.199671Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:48.200067Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:48.397273Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:48.534104Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:48.574539Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:48.681624Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:48.867528Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:53.663802Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:53.664528Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:53.665793Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:53.667451Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:53.961065Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:55.258521Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:55.25944Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:55.260105Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:55.262133Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:00:55.26322Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:00:55.68718Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:02.668696Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:02.669436Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:02.669938Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:01:02.90361Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:08.556589Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:08.557769Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:01:09.021453Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:01:09.159337Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:09.96969Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:01:10.382459Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:14.951131Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:14.952108Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:14.952737Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:14.953269Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:01:15.372642Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:16.104333Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:01:16.463787Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:20.438806Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:01:20.798318Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:21.007904Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:21.008532Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:21.0097Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:01:25.482045Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:27.922634Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:29.293506Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:01:29.678062Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:01:29.813469Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:34.785867Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:01:35.131157Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:01:38.027332Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:01:45.101474Z"
      },
      {
        "status": "in_progress",
        "tool": "Task",
        "work": null,
        "at": "2026-01-28T10:02:54.249145Z"
      },
      {
        "status": "in_progress",
        "tool": "Task",
        "work": null,
        "at": "2026-01-28T10:03:32.676366Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:03:39.729024Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:03:39.729856Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:03:40.061091Z"
      },
      {
        "status": "in_progress",
        "tool": "mcp__cortex__readTicket",
        "work": null,
        "at": "2026-01-28T10:04:28.534419Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:04:32.270713Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:04:32.2715Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:04:32.603264Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:04:39.016988Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:04:39.147457Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:04:39.286542Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:04:43.028333Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:04:43.371504Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:04:48.969552Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:04:49.105055Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:04:54.187904Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:04:55.407428Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:05:01.785034Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:05:02.083688Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:05:07.658222Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:05:08.064206Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:05:14.112409Z"
      },
      {
        "status": "in_progress",
        "tool": "Task",
        "work": null,
        "at": "2026-01-28T10:07:34.695328Z"
      },
      {
        "status": "in_progress",
        "tool": "Write",
        "work": null,
        "at": "2026-01-28T10:08:16.592681Z"
      },
      {
        "status": "waiting_permission",
        "tool": null,
        "work": null,
        "at": "2026-01-28T10:08:22.81649Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:10:41.292327Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:10:41.293139Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:10:41.612258Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:10:49.584551Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:10:50.938275Z"
      },
      {
        "status": "in_progress",
        "tool": "Glob",
        "work": null,
        "at": "2026-01-28T10:10:54.760315Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:10:56.805065Z"
      },
      {
        "status": "in_progress",
        "tool": "Task",
        "work": null,
        "at": "2026-01-28T10:11:01.557941Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:11:06.608016Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:11:19.726348Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:11:25.784598Z"
      },
      {
        "status": "in_progress",
        "tool": "Edit",
        "work": null,
        "at": "2026-01-28T10:11:35.367545Z"
      },
      {
        "status": "in_progress",
        "tool": "Edit",
        "work": null,
        "at": "2026-01-28T10:11:49.009235Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:11:55.946637Z"
      },
      {
        "status": "in_progress",
        "tool": "Edit",
        "work": null,
        "at": "2026-01-28T10:12:00.815338Z"
      },
      {
        "status": "in_progress",
        "tool": "Edit",
        "work": null,
        "at": "2026-01-28T10:12:14.943209Z"
      },
      {
        "status": "in_progress",
        "tool": "Read",
        "work": null,
        "at": "2026-01-28T10:15:23.658199Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:20:28.398797Z"
      },
      {
        "status": "in_progress",
        "tool": "Write",
        "work": null,
        "at": "2026-01-28T10:23:08.800017Z"
      },
      {
        "status": "in_progress",
        "tool": "Edit",
        "work": null,
        "at": "2026-01-28T10:23:16.90501Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:23:23.748563Z"
      },
      {
        "status": "in_progress",
        "tool": "Grep",
        "work": null,
        "at": "2026-01-28T10:23:31.818876Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:23:40.112557Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:23:47.782822Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:09.754779Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:16.762841Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:22.57235Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:28.49687Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:34.889701Z"
      },
      {
        "status": "in_progress",
        "tool": "TodoWrite",
        "work": null,
        "at": "2026-01-28T10:24:40.971072Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:47.904673Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:47.933765Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:47.934545Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:24:58.449164Z"
      },
      {
        "status": "in_progress",
        "tool": "mcp__cortex__requestReview",
        "work": null,
        "at": "2026-01-28T10:25:21.76622Z"
      },
      {
        "status": "idle",
        "tool": null,
        "work": null,
        "at": "2026-01-28T10:25:29.680262Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:30:42.938627Z"
      },
      {
        "status": "in_progress",
        "tool": "Bash",
        "work": null,
        "at": "2026-01-28T10:30:54.028006Z"
      }
    ],
    "requested_reviews": [
      {
        "repo_path": "/Users/kareemelbahrawy/projects/cortex1",
        "title": "Ticket TUI overhaul: row-based layout with unified comment list",
        "content": "## Summary\n\nReplaced the old left/right split panel layout in the ticket detail TUI with a two-row design:\n\n### Files Changed\n- **styles.go** — Added `row2FocusedStyle`, `row2Style`, `commentSelectedStyle`, `rowSeparatorStyle`, renamed sidebar styles to `attribute*` and `dot*` styles. Changed `reviewRequestedColor` from blue (39) to yellow (214). Removed 5 obsolete panel styles (`leftPanelFocusedStyle`, `leftPanelStyle`, `sidebarFocusedStyle`, `sidebarStyle`, `sidebarSelectedStyle`).\n\n- **keys.go** — Added `KeyTab` and `KeyShiftTab` constants. Rewrote `helpText()` with new signature accepting `focusedRow int` instead of `splitLayout, rightFocused bool`. Help hints now show `[Tab] comments/body` based on focus.\n\n- **model.go** — Major rewrite:\n  - **Struct**: `leftViewport` → `bodyViewport`, `focusedPanel` → `focusedRow`, `sidebarCursor` → `commentCursor`, `modalIsReview`+`modalItemIndex` → `modalCommentIdx`, removed `splitLayout`\n  - **New functions (12)**: `rowHeights`, `renderRow1`, `renderAttributes`, `renderCommentList`, `renderCommentLine`, `commentBadge`, `stripMarkdownPreview`, `truncateToWidth`, `commentVisibleRange`, `renderRowSeparator`, `handleCommentListKey`, `updateRowSizes`, `renderBodyContent`\n  - **Removed functions (18)**: `renderSplitLayout`, `renderSidebar`, `renderSidebarDetails`, `renderSidebarSession`, `renderSidebarReviews`, `renderSidebarComments`, `renderContent`, `renderLeftContent`, `renderReviewRequests`, `renderComments`, `renderSection`, `renderDates`, `renderSession`, `reviewComments`, `nonReviewComments`, `isSidebarReview`, `sidebarReviewCount`, `leftPanelWidth`, `rightPanelWidth`, `handleRightPanelKey`, `sidebarItemCount`\n  - **Rewritten**: `View()`, `Update()`, `handleKeyMsg()`, `openDetailModal()`, `renderDetailModal()`, `renderModalHeader()`, `renderModalContent()`, `handleDetailModalKey()`, `hasReviewRequests()`\n\n### Layout Design\n- **Row 1** (body + attributes): Takes 70% height when focused, 30% when not. Wide terminals (\u003e=100 chars) show body | divider | attributes side-by-side. Narrow terminals show body only with dates/session prepended.\n- **Row 2** (comment list): Unified list of all comments with type badges, content previews, and relative timestamps. Scrollable with cursor selection.\n- **Tab/Shift+Tab** switches focus between rows, dynamically resizing both.\n- **Comment badges**: `[review]` yellow, `[blocker]` red, `[done]` green, `[comment]` gray.\n- **Modal**: Now indexes directly into `ticket.Comments` instead of maintaining separate review/comment splits.\n\n### Verification\n- `make build` — passes\n- `make lint` — passes (0 issues)\n- `make test` — all tests pass",
        "requested_at": "2026-01-28T10:25:21.046169Z"
      }
    ]
  }
}